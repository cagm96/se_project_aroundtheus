!function(){"use strict";class e{constructor(e,t,r,s,o,i){let{isLiked:n,name:a,link:l,_id:c}=e;this._isLiked=n,this._name=a,this._link=l,this._id=c,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteButton=s,this._handleLikeButtonClick=o,this._removeLikeButton=i}_setEventListeners(){this._cardElement.querySelector(".card__like-button").addEventListener("click",(()=>{this._isLiked?(this._removeLikeButton(this._id),this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active")):(this._handleLikeButtonClick(this._id),this._cardElement.querySelector(".card__like-button").classList.toggle("card__like-button_active"))})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteButton(this._id,this._cardElement)})),this._cardElement.querySelector(".card__overlay-button").addEventListener("click",(()=>{this._handleImageClick(this._name,this._link)}))}_getElement(){return this._cardSelector.content.querySelector(".card").cloneNode(!0)}getView(){this._cardElement=this._getElement();const e=this._cardElement.querySelector(".card__image");return this._isLiked?this._cardElement.querySelector(".card__like-button").classList.add("card__like-button_active"):this._cardElement.querySelector(".card__like-button").classList.remove("card__like-button_active"),e.src=this._link,e.alt=this._name,this._cardElement.querySelector(".card__title").textContent=this._name,this._setEventListeners(),this._cardElement}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t}_showInputError(e,t){const r=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),r.textContent=t,r.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}toggleButtonState(){const e=this._form.querySelectorAll(this._inputSelector),t=this._form.querySelector(this._submitButtonSelector);this._hasInvalidInput(e)?(t.classList.add(this._inactiveButtonClass),t.disabled=!0):(t.classList.remove(this._inactiveButtonClass),t.disabled=!1)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(e){return Array.from(e).some((e=>!e.validity.valid))}_setEventListeners(){this._form.querySelectorAll(this._inputSelector).forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class r{constructor(e){this._popupElement=document.querySelector(e),this._closeButton=this._popupElement.querySelector(".modal__close")}_handleEscClose=e=>{"Escape"===e.key&&this.close()};open(){this._popupElement.classList.add("modal_open"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popupElement.classList.remove("modal_open"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(e=>{e.target.classList.contains("modal_open")&&this.close(),e.target.classList.contains("modal__close")&&this.close()}))}}class s extends r{constructor(e,t){super(e),this._handleFormSubmit=t,this._submitButton=this._popupElement.querySelector(".modal__button"),this._form=this._popupElement.querySelector(".modal__form")}test(){console.log(this._submitButton)}_getInputValues(){const e=[...this._popupElement.querySelectorAll("input")],t={};for(const r of e)t[r.name]=r.value;return t}close(){super.close(),this._form.reset()}setEventListeners(){this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this._getInputValues();this._handleFormSubmit(t,this._submitButton),this.close()})),super.setEventListeners()}}const o=document.querySelector("#card-template"),i=document.querySelector("#profile-edit-button"),n=document.forms.modal__form,a=n.querySelector("#profile-title-input"),l=n.querySelector("#profile-description-Input"),c=document.querySelector(".cards__list"),d=document.querySelector(".profile__add-button"),_=document.querySelector("#add-card-modal").querySelector(".modal__form"),u={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},h=document.querySelector(".profile__button"),m=document.querySelector("#profile-avatar-modal"),p=document.querySelector(".profile__image"),E=m.querySelector(".modal__form"),v=new class{constructor(e,t){this._profileName=document.querySelector(e),this._job=document.querySelector(t)}getUserInfo(){return{profileName:this._profileName.textContent,profileJob:this._job.textContent}}setUserInfo(e){this._profileName.textContent=e.name,this._job.textContent=e.about}}(".profile__title",".profile__description"),f=new class{constructor(e,t){this._renderer=e,this._container=t}renderItems(e){e.forEach((e=>{const t=this._renderer(e);this._container.append(t)}))}addItem(e){let{name:t,link:r,_id:s}=e;const o=this._renderer({name:t,link:r,_id:s});this._container.prepend(o)}}((function(t){return new e(t,o,((e,t)=>{L.open(e,t)}),((e,t)=>{b.open(),b.setEventListeners(),b.setSubmitAction((()=>{S.deleteCard(e),t.remove()}))}),(e=>{S.likeCard(e).then((e=>{console.log(e)}))}),(e=>{S.unlikeCard(e).then((e=>{console.log(e)}))})).getView()}),c),S=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}getUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}setUserInfo(e,t){return t.textContent="Saving ...",fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((e=>e.ok?(t.textContent="Save",e.json()):Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}getUserAvatar(){return fetch(`${this._url}/users/me/avatar`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}setUserAvatar(e,t){return t.textContent="Saving ...",fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then((e=>e.ok?(t.textContent="Save",e.json()):Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}addCard(e,t){return t.textContent="Saving ...",fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((e=>e.ok?(t.textContent="Save",e.json()):Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}likeCard(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}unlikeCard(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>Promise.reject(`Error: ${e}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"f1dab6ed-e5ba-44ef-bef1-7369d7e9bf0d","Content-Type":"application/json"}});S.getUserInfo().then((e=>{v.setUserInfo(e)})),S.getInitialCards().then((e=>{f.renderItems(e)})),S.getUserInfo().then((e=>{p.src=e.avatar}));const b=new class extends r{constructor(e){super(e),this._answerButton=this._popupElement.querySelector(".modal__button"),this._form=this._popupElement.querySelector(".modal__form")}setSubmitAction(e){this._handleFormSubmit=e}setEventListeners(){this._answerButton.addEventListener("click",(e=>{e.preventDefault(),this._handleFormSubmit(),this.close()})),super.setEventListeners()}}("#delete-card-modal");new t(u,n).enableValidation();const k=new t(u,_);k.enableValidation();const y=new t(u,E);y.enableValidation();const L=new class extends r{constructor(e){super(e),this._imageFull=this._popupElement.querySelector(".modal__image"),this._modalTitle=this._popupElement.querySelector(".modal__image-title")}test(){console.log(this.popupElement)}open(e,t){this._modalTitle.textContent=e,this._imageFull.setAttribute("src",t),this._imageFull.setAttribute("alt",e),super.open()}}("#image-modal");L.setEventListeners();const g=new s("#add-card-modal",((e,t)=>{S.addCard(e,t).then((e=>{f.addItem(e)})),k.toggleButtonState(),g.close()}));g.setEventListeners();const C=new s("#profile-avatar-modal",((e,t)=>{S.setUserAvatar(e,t).then((e=>{p.src=e.avatar})),y.toggleButtonState(),C.close()}));C.setEventListeners();const q=new s("#profile-edit-modal",((e,t)=>{v.setUserInfo(e),S.setUserInfo(e,t),q.close()}));q.setEventListeners(),d.addEventListener("click",(()=>{g.open()})),i.addEventListener("click",(()=>{q.open();const{profileName:e,profileJob:t}=v.getUserInfo();a.value=e,l.value=t})),h.addEventListener("click",(()=>{C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RUFBWVUsUUFBUVcsRUFBSSxJQUUxQjRCLEVBQWlCdkgsb0JBQ2pCNEgsRUFBVW5HLE9BQU8sSUFHckJtRyxFQUFVaEcsb0JBRVYsTUFBTWlHLEVBQWUsSUFBSTlGLEVBQ3ZCLHlCQUNBLENBQUMrRixFQUFLM0gsS0FFSm9GLEVBQUl3QixjQUFjZSxFQUFLM0gsR0FBY3VGLE1BQU1DLElBQ3pDaEMsRUFBYWxGLElBQU1rSCxFQUFJeUIsTUFBTSxJQUcvQkksRUFBMkJ4SCxvQkFDM0I2SCxFQUFhcEcsT0FBTyxJQUd4Qm9HLEVBQWFqRyxvQkFFYixNQUFNbUcsRUFBZ0IsSUFBSWhHLEVBQ3hCLHVCQUNBLENBQUNjLEVBQVExQyxLQUNQMEQsRUFBU08sWUFBWXZCLEdBQ3JCMEMsRUFBSW5CLFlBQVl2QixFQUFRMUMsR0FDeEI0SCxFQUFjdEcsT0FBTyxJQUd6QnNHLEVBQWNuRyxvQkF3Q2R5QixFQUFpQnRGLGlCQUFpQixTQUFTLEtBQ3pDNkosRUFBVWxHLE1BQU0sSUFFbEJxQixFQUFrQmhGLGlCQUFpQixTQUFTLEtBQzFDZ0ssRUFBY3JHLE9BRWQsTUFBTSxZQUFFb0MsRUFBVyxXQUFFSyxHQUFlTixFQUFTSyxjQUU3Q2hCLEVBQWlCUCxNQUFRbUIsRUFDekJYLEVBQWdCUixNQUFRd0IsQ0FBVSxJQUdwQ1YsRUFBYzFGLGlCQUFpQixTQUFTLEtBQ3RDOEosRUFBYW5HLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFF1ZXN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeyBpc0xpa2VkLCBuYW1lLCBsaW5rLCBfaWQgfSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVCdXR0b24sXHJcbiAgICBoYW5kbGVMaWtlQnV0dG9uQ2xpY2ssXHJcbiAgICByZW1vdmVMaWtlQnV0dG9uXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9pZCA9IF9pZDtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uID0gaGFuZGxlRGVsZXRlQnV0dG9uO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbkNsaWNrID0gaGFuZGxlTGlrZUJ1dHRvbkNsaWNrO1xyXG4gICAgdGhpcy5fcmVtb3ZlTGlrZUJ1dHRvbiA9IHJlbW92ZUxpa2VCdXR0b247XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICBpZiAodGhpcy5faXNMaWtlZCkge1xyXG4gICAgICAgICAgdGhpcy5fcmVtb3ZlTGlrZUJ1dHRvbih0aGlzLl9pZCk7XHJcbiAgICAgICAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAgICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbkNsaWNrKHRoaXMuX2lkKTtcclxuXHJcbiAgICAgICAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKVxyXG4gICAgICAgICAgICAuY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQnV0dG9uKHRoaXMuX2lkLCB0aGlzLl9jYXJkRWxlbWVudCk7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX292ZXJsYXktYnV0dG9uXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbmFtZSwgdGhpcy5fbGluayk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2dldEVsZW1lbnQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZFNlbGVjdG9yLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIGdldFZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldEVsZW1lbnQoKTtcclxuICAgIGNvbnN0IGNhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgICAuY2xhc3NMaXN0LmFkZChcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIilcclxuICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICAgIGNhcmRJbWFnZUVsLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICBjYXJkSW1hZ2VFbC5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIGNvbnN0IGNhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuICAgIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcclxuXHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWwsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWwuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsKSB7XHJcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgaW5wdXRFbHMgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3Rvcik7XHJcbiAgICBjb25zdCBzdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dChpbnB1dEVscykpIHtcclxuICAgICAgc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHN1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBzdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWwpIHtcclxuICAgIGlmICghaW5wdXRFbC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsLCBpbnB1dEVsLnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dEVscykge1xyXG4gICAgcmV0dXJuIEFycmF5LmZyb20oaW5wdXRFbHMpLnNvbWUoKGlucHV0RWwpID0+ICFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIGNvbnN0IGlucHV0RWxzID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpO1xyXG5cclxuICAgIGlucHV0RWxzLmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChlKSA9PiB7XHJcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiLy8gVGhlIFBvcHVwIGNsYXNzIGlzIGEgZ2VuZXJpYyBjbGFzcyB0aGF0IG9wZW5zIGFuZCBjbG9zZXMgYSBwb3B1cC5cclxuLy8gWW91IHdvbuKAmXQgaW5zdGFudGlhdGUgeW91ciBQb3B1cCBjbGFzcyBkaXJlY3RseSBpbiBpbmRleC5qczsgaW5zdGVhZCwgeW914oCZbGwgaW5zdGFudGlhdGUgaXRzIGNoaWxkcmVuIGNsYXNzZXNcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cEVsZW1lbnQpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XHJcbiAgfVxyXG5cclxuICAvLyBJdCBoYXMgYSBwcml2YXRlIG1ldGhvZCBuYW1lZCBfaGFuZGxlRXNjQ2xvc2UoKSB0aGF0IHN0b3JlcyB0aGUgbG9naWMgZm9yIGNsb3NpbmcgdGhlIHBvcHVwXHJcbiAgLy8gYnkgcHJlc3NpbmcgdGhlIEVzYyBrZXkuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgLy8gQXNzdW1pbmcgJ3RoaXMnIHJlZmVycyB0byB0aGUgb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGNsb3NlKCkgbWV0aG9kXHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICAvLyBUaGUgb3BlbigpIG1ldGhvZCBzaG91bGQgYmUgY2FsbGVkIGluIHRoZSBwcmVleGlzdGluZyBldmVudCBoYW5kbGVycyBpbiBpbmRleC5qcy5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5cIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICAvLyAgIHRvIHRoZSBjbG9zZSBpY29uIG9mIHRoZSBwb3B1cC5cclxuICAvLyBUaGUgbW9kYWwgd2luZG93IHNob3VsZCBhbHNvIGNsb3NlIHdoZW4gdXNlcnMgY2xpY2sgb24gdGhlIHNoYWRlZCBhcmVhIGFyb3VuZCB0aGUgZm9ybS5cclxuICAvLyBZb3Ugd29u4oCZdCBpbnN0YW50aWF0ZSB5b3VyIFBvcHVwIGNsYXNzIGRpcmVjdGx5IGluIGluZGV4LmpzO1xyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlblwiKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIikpIHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbi8vSXQgYWNjZXB0cyB0d28gYXJndW1lbnRzOiB0aGUgcG9wdXAgc2VsZWN0b3IgYW5kIGEgY2FsbGJhY2sgZnVuY3Rpb24sXHJcbi8vd2hpY2ggUG9wdXBXaXRoRm9ybSBjYWxscyB3aGVuIHRoZSBmb3Jt4oCZcyBzdWJtaXQgZXZlbnQgZmlyZXMuXHJcbi8vIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiB0aGUgUG9wdXBXaXRoRm9ybSBjbGFzcyBmb3IgZWFjaCBwb3B1cFxyXG4vLyB0aGF0IGNvbnRhaW5zIGEgZm9ybSwgYW5kIGNhbGwgdGhlaXIgc2V0RXZlbnRMaXN0ZW5lcnMoKSBtZXRob1xyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCwgaGFuZGxlRm9ybVN1Ym1pdCkge1xyXG4gICAgc3VwZXIocG9wdXBFbGVtZW50KTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICB9XHJcblxyXG4gIHRlc3QoKSB7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9zdWJtaXRCdXR0b24pO1xyXG4gIH1cclxuXHJcbiAgLy8gY29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIGl0IGFzIGFuIG9iamVjdC5cclxuICAvLyBUaGlzIGRhdGEgc2hvdWxkIHRoZW4gYmUgcGFzc2VkIHRvIHRoZSBzdWJtaXNzaW9uIGhhbmRsZXIgYXMgYW4gYXJndW1lbnQuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gWy4uLnRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIildO1xyXG5cclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcblxyXG4gICAgZm9yIChjb25zdCBpbnB1dCBvZiBpbnB1dExpc3QpIHtcclxuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICB9XHJcblxyXG4gIC8vIEl0IG92ZXJyaWRlcyB0aGUgc2V0RXZlbnRMaXN0ZW5lcnMoKSBwYXJlbnQgbWV0aG9kLlxyXG4gIC8vIFRoZSBzZXRFdmVudExpc3RlbmVycygpIG1ldGhvZCBvZiB0aGUgUG9wdXBXaXRoRm9ybSBjbGFzcyBzaG91bGQgYWRkIGFcclxuICAvLyBzdWJtaXQgZXZlbnQgbGlzdGVuZXIgdG8gdGhlIGZvcm0gYW5kIGNhbGwgdGhlIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kIG9mIHRoZSBwYXJlbnQgY2xhc3MuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuXHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodmFsdWVzLCB0aGlzLl9zdWJtaXRCdXR0b24pO1xyXG5cclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBRdWVzdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFF1ZXN0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuXHJcbi8vLS0tLS0tLS0tLS0tLS0tRWxlbWVudHNcclxuY29uc3QgY2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJtb2RhbF9fZm9ybVwiXTtcclxuXHJcbmNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBwcm9maWxlRWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlLWlucHV0XCIpO1xyXG5jb25zdCBwcm9maWxlSm9iSW5wdXQgPSBwcm9maWxlRWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLWRlc2NyaXB0aW9uLUlucHV0XCJcclxuKTtcclxuLy9jYXJkcyBhZGQgbW9kYWxcclxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmNvbnN0IGNhcmRBZGRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGNhcmRBZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5cclxuLy9pbWFnZSBtb2RhbCBidXR0b25zXHJcbmNvbnN0IGNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbmNvbnN0IHByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2J1dHRvblwiKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVBdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXJNb2RhbEZvcm0gPSBwcm9maWxlQXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFwiLnByb2ZpbGVfX3RpdGxlXCIsIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHJlbmRlckNhcmQsIGNhcmRMaXN0RWwpO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiZjFkYWI2ZWQtZTViYS00NGVmLWJlZjEtNzM2OWQ3ZTliZjBkXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHJlcykgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XHJcbn0pO1xyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigocmVzKSA9PiB7XHJcbiAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMocmVzKTtcclxufSk7XHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHJlcykgPT4ge1xyXG4gIHByb2ZpbGVJbWFnZS5zcmMgPSByZXMuYXZhdGFyO1xyXG59KTtcclxuXHJcbmNvbnN0IGNhcmREZWxldGVNb2RhbCA9IG5ldyBQb3B1cFF1ZXN0aW9uKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZpbGVFZGl0Rm9ybSk7XHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgYWRkQ2FyZEZvcm1FbGVtZW50KTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmNvbnN0IHByb2ZpbGVBdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uZmlnLFxyXG4gIHByb2ZpbGVBdmF0YXJNb2RhbEZvcm1cclxuKTtcclxuXHJcbnByb2ZpbGVBdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIiNpbWFnZS1tb2RhbFwiKTtcclxuaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgY2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjYWRkLWNhcmQtbW9kYWxcIixcclxuICAvLyBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdFxyXG4gIChsaW5rLCBzdWJtaXRCdXR0b24pID0+IHtcclxuICAgIGFwaS5hZGRDYXJkKGxpbmssIHN1Ym1pdEJ1dHRvbikudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0ocmVzKTtcclxuICAgIH0pO1xyXG4gICAgYWRkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgY2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgfVxyXG4pO1xyXG5jYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIFwiI3Byb2ZpbGUtYXZhdGFyLW1vZGFsXCIsXHJcbiAgKHVybCwgc3VibWl0QnV0dG9uKSA9PiB7XHJcbiAgICAvLyBoYW5kbGVzIHRoZSBhdmF0YXIgcGljdHVyZSBzdWJtaXRcclxuICAgIGFwaS5zZXRVc2VyQXZhdGFyKHVybCwgc3VibWl0QnV0dG9uKS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcHJvZmlsZUltYWdlLnNyYyA9IHJlcy5hdmF0YXI7XHJcbiAgICB9KTtcclxuXHJcbiAgICBwcm9maWxlQXZhdGFyRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgcHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgfVxyXG4pO1xyXG5wcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICAodmFsdWVzLCBzdWJtaXRCdXR0b24pID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHZhbHVlcyk7XHJcbiAgICBhcGkuc2V0VXNlckluZm8odmFsdWVzLCBzdWJtaXRCdXR0b24pO1xyXG4gICAgdXNlckluZm9Qb3B1cC5jbG9zZSgpO1xyXG4gIH1cclxuKTtcclxudXNlckluZm9Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgIGNhcmREYXRhLFxyXG4gICAgY2FyZFRlbXBsYXRlLFxyXG5cclxuICAgIC8vaGFuZGxlcyB0aGUgaW1hZ2UgY2xpY2tcclxuICAgIChuYW1lLCBsaW5rKSA9PiB7XHJcbiAgICAgIGltYWdlUG9wdXAub3BlbihuYW1lLCBsaW5rKTtcclxuICAgIH0sXHJcbiAgICAvL2hhbmRsZXMgdGhlIGRlbGV0ZSBidXR0b24gY2xpY2tcclxuICAgIChpZCwgY2FyZEVsZW1lbnQpID0+IHtcclxuICAgICAgY2FyZERlbGV0ZU1vZGFsLm9wZW4oKTtcclxuICAgICAgY2FyZERlbGV0ZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgIGNhcmREZWxldGVNb2RhbC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGlkKTtcclxuICAgICAgICBjYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgICAvLyBjYXJkRWxlbWVudCA9IG51bGw7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIC8vaGFuZGxlcyBMaWtlIEJ1dHRvbiBDbGlja1xyXG4gICAgKGlkKSA9PiB7XHJcbiAgICAgIGFwaS5saWtlQ2FyZChpZCkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgfSk7XHJcbiAgICB9LFxyXG4gICAgLy9yZW1vdmVzIExpa2UgQnV0dG9uXHJcbiAgICAoaWQpID0+IHtcclxuICAgICAgYXBpLnVubGlrZUNhcmQoaWQpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKHJlcyk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gICk7XHJcblxyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufVxyXG5cclxuLy8gRVZFTlQgTElTVEVORVJTXHJcblxyXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2FyZFBvcHVwLm9wZW4oKTtcclxufSk7XHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgdXNlckluZm9Qb3B1cC5vcGVuKCk7XHJcblxyXG4gIGNvbnN0IHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVKb2IgfSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcblxyXG4gIHByb2ZpbGVOYW1lSW5wdXQudmFsdWUgPSBwcm9maWxlTmFtZTtcclxuICBwcm9maWxlSm9iSW5wdXQudmFsdWUgPSBwcm9maWxlSm9iO1xyXG59KTtcclxuXHJcbnByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlUG9wdXAub3BlbigpO1xyXG59KTtcclxuIiwiLy8gVGhlIFVzZXJJbmZvIGNsYXNzIGlzIHJlc3BvbnNpYmxlIGZvciByZW5kZXJpbmcgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIgb24gdGhlIHBhZ2UuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICAvLyBUYWtlIGFuIG9iamVjdCB3aXRoIHRoZSBzZWxlY3RvcnMgb2YgdHdvIGVsZW1lbnRzIGludG8gdGhlIGNvbnN0cnVjdG9yOlxyXG4gIC8vb25lIGZvciB0aGUgcHJvZmlsZeKAmXMgbmFtZSBlbGVtZW50IGFuZCBvbmUgZm9yIGl0cyBqb2IgZWxlbWVudC5cclxuICBjb25zdHJ1Y3Rvcihwcm9maWxlTmFtZSwgam9iKSB7XHJcbiAgICB0aGlzLl9wcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZU5hbWUpOyAvL1wiLnByb2ZpbGVfX3RpdGxlXCIgIHRoZSBjdXJyZW50IGluZm9cclxuICAgIHRoaXMuX2pvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iKTsgLy8gXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxyXG4gIH1cclxuICAvL1JldHVybnMgYW4gb2JqZWN0IGNvbnRhaW5pbmcgaW5mb3JtYXRpb24gYWJvdXQgdGhlIHVzZXIuXHJcbiAgLy9UaGlzIG1ldGhvZCB3aWxsIGJlIGhhbmR5IGZvciBjYXNlcyB3aGVuIGl0J3MgbmVjZXNzYXJ5IHRvIGRpc3BsYXkgdGhlIHVzZXIgZGF0YSBpbiB0aGUgb3BlbiBmb3JtLlxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgY29uc3QgdXNlckluZm8gPSB7XHJcbiAgICAgIHByb2ZpbGVOYW1lOiB0aGlzLl9wcm9maWxlTmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgcHJvZmlsZUpvYjogdGhpcy5fam9iLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuXHJcbiAgICByZXR1cm4gdXNlckluZm87XHJcbiAgfVxyXG5cclxuICAvL3doaWNoIHRha2VzIG5ldyB1c2VyIGRhdGEgYW5kIGFkZHMgaXQgdG8gdGhlIHBhZ2UuXHJcbiAgLy9UaGlzIG1ldGhvZCBzaG91bGQgYmUgdXNlZCBhZnRlciBzdWNjZXNzZnVsIHN1Ym1pc3Npb24gb2YgdGhlIHByb2ZpbGUgZm9ybS5cclxuICBzZXRVc2VySW5mbyh2YWx1ZXMpIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gdmFsdWVzLm5hbWU7XHJcbiAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSB2YWx1ZXMuYWJvdXQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHJlbmRlcmVyLCBjb250YWluZXIpIHtcclxuICAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICAvLyBUaGUgaXRlbXMgcHJvcGVydHkgc2hvdWxkIGJlIGFuIGFycmF5IG9mIGRhdGEsXHJcbiAgICAvLyB3aGljaCB5b3UgbXVzdCBhZGQgdG8gdGhlIHBhZ2Ugd2hlbiBpdCBsb2Fkcy5cclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAvLyBUaGUgcmVuZGVyZXIgcHJvcGVydHkgc2hvdWxkIGJlIGEgZnVuY3Rpb24gdGhhdFxyXG4gICAgLy8gY3JlYXRlcyBhbmQgYWRkcyBhIHNpbmdsZSBpdGVtIHRvIHRoZSBwYWdlLlxyXG4gICAgdGhpcy5fY29udGFpbmVyID0gY29udGFpbmVyO1xyXG4gICAgLy8gYSBDU1MgY2xhc3Mgc2VsZWN0b3Igd2hlcmUgeW91J2xsIGFkZCB0aGUgY2FyZCBlbGVtZW50cy5cclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XHJcbiAgICAvLyAgIC8vSXQgc2hvdWxkIGl0ZXJhdGUgdGhyb3VnaCB0aGUgaXRlbXMgYXJyYXkgYW5kIGNhbGwgdGhlIHJlbmRlcmVyKCkgZnVuY3Rpb24gb24gZWFjaCBpdGVtLlxyXG4gICAgLy8gICAvL1RoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgb25jZSBvbiBwYWdlIGxvYWQuXHJcbiAgICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgICAgdGhpcy5fY29udGFpbmVyLmFwcGVuZChlbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy8gdGFrZXMgYSBET00gZWxlbWVudCBhbmQgYWRkcyBpdCB0byB0aGUgY29udGFpbmVyLlxyXG4gIC8vIFRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgd2hlbiBhZGRpbmcgYW4gaW5kaXZpZHVhbCBjYXJkIHRvIHRoZSBET00uXHJcbiAgYWRkSXRlbSh7IG5hbWUsIGxpbmssIF9pZCB9KSB7XHJcbiAgICBjb25zdCBlbGVtZW50ID0gdGhpcy5fcmVuZGVyZXIoeyBuYW1lLCBsaW5rLCBfaWQgfSk7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xyXG4gICAgLy8gdGhpcy5fdGVzdCA9XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHZhbHVlcywgc3VibWl0QnV0dG9uKSB7XHJcbiAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZyAuLi5cIjtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodmFsdWVzKSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vycm9yfWApO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJBdmF0YXIoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke2Vycm9yfWApO1xyXG4gICAgICB9KTtcclxuICB9XHJcbiAgc2V0VXNlckF2YXRhcihsaW5rLCBzdWJtaXRCdXR0b24pIHtcclxuICAgIHN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nIC4uLlwiO1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkobGluayksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnJvcn1gKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7ZXJyb3J9YCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZChpbnB1dCwgc3VibWl0QnV0dG9uKSB7XHJcbiAgICBzdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZyAuLi5cIjtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShpbnB1dCksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnJvcn1gKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIC8vIGJvZHk6IEpTT04uc3RyaW5naWZ5KGNhcmRJZCksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7ZXJyb3J9YCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtlcnJvcn1gKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7ZXJyb3J9YCk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBRdWVzdGlvbiBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cEVsZW1lbnQpIHtcclxuICAgIHN1cGVyKHBvcHVwRWxlbWVudCk7XHJcbiAgICAvL3RoaXMuX2hhbmRsZUJ1dHRvbkNsaWNrID0gaGFuZGxlQnV0dG9uQ2xpY2s7XHJcbiAgICB0aGlzLl9hbnN3ZXJCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihmbikge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGZuO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9hbnN3ZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoKTtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIC8vQ3JlYXRlIG9uZSBpbnN0YW5jZSBvZiB0aGlzIGNsYXNzIGluIGluZGV4LmpzIGFuZCBjYWxsIGl0cyBwYXJlbnTigJlzIHNldEV2ZW50TGlzdGVuZXJzKCkgbWV0aG9kLlxyXG4gIGNvbnN0cnVjdG9yKHBvcHVwRWxlbWVudCkge1xyXG4gICAgc3VwZXIocG9wdXBFbGVtZW50KTtcclxuICAgIHRoaXMuX2ltYWdlRnVsbCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcclxuICAgIHRoaXMuX21vZGFsVGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2UtdGl0bGVcIik7XHJcbiAgfVxyXG4gIC8vIFRoZSBvcGVuKCkgbWV0aG9kIG9mIHRoZSBQb3B1cFdpdGhJbWFnZSBjbGFzcyB3aWxsIG5lZWQgdG8gYWNjZXB0IHRoZSBuYW1lIGFuZCBsaW5rIG9mIHRoZSBjYXJkIGFzIGFyZ3VtZW50c1xyXG4gIC8vIGFuZCBhZGQgYW4gaW1hZ2UgdG8gdGhlIHBvcHVwIGFuZCB0aGUgY29ycmVzcG9uZGluZyBpbWFnZSBzcmMgYXR0cmlidXRlIGFsb25nIHdpdGggYSBjYXB0aW9uIGZvciB0aGUgaW1hZ2UuXHJcbiAgLy8gIFRoaXMgbWV0aG9kIHNob3VsZCBiZSBjYWxsZWQgaW4geW91ciBpbWFnZSBjbGljayBoYW5kbGVyIGluIGluZGV4LmpzLlxyXG4gIHRlc3QoKSB7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLnBvcHVwRWxlbWVudCk7XHJcbiAgfVxyXG4gIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgLy8gZGF0YSBzaG91bGQgYmUgYW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIG5hbWUgYW5kIGxpbmtcclxuICAgIC8vIHNldCB0aGUgaW1hZ2UncyBzcmMgYW5kIGFsdFxyXG4gICAgLy8gc2V0IHRoZSBjYXB0aW9uJ3MgdGV4dENvbnRlbnRcclxuXHJcbiAgICB0aGlzLl9tb2RhbFRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2ltYWdlRnVsbC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgbGluayk7XHJcbiAgICB0aGlzLl9pbWFnZUZ1bGwuc2V0QXR0cmlidXRlKFwiYWx0XCIsIG5hbWUpO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVCdXR0b24iLCJoYW5kbGVMaWtlQnV0dG9uQ2xpY2siLCJyZW1vdmVMaWtlQnV0dG9uIiwiaXNMaWtlZCIsIm5hbWUiLCJsaW5rIiwiX2lkIiwidGhpcyIsIl9pc0xpa2VkIiwiX25hbWUiLCJfbGluayIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJfaGFuZGxlTGlrZUJ1dHRvbkNsaWNrIiwiX3JlbW92ZUxpa2VCdXR0b24iLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiYWRkRXZlbnRMaXN0ZW5lciIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9nZXRFbGVtZW50IiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJjYXJkSW1hZ2VFbCIsImFkZCIsInJlbW92ZSIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm0iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsIiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JNZXNzYWdlRWwiLCJpZCIsIl9oaWRlSW5wdXRFcnJvciIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiaW5wdXRFbHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwic3VibWl0QnV0dG9uIiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIkFycmF5IiwiZnJvbSIsInNvbWUiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsIlBvcHVwIiwicG9wdXBFbGVtZW50IiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwiX2Nsb3NlQnV0dG9uIiwiX2hhbmRsZUVzY0Nsb3NlIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJvcGVuIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfc3VibWl0QnV0dG9uIiwidGVzdCIsImNvbnNvbGUiLCJsb2ciLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dExpc3QiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsInZhbHVlcyIsImNhcmRUZW1wbGF0ZSIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRGb3JtIiwiZm9ybXMiLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZUpvYklucHV0IiwiY2FyZExpc3RFbCIsImFkZE5ld0NhcmRCdXR0b24iLCJhZGRDYXJkRm9ybUVsZW1lbnQiLCJjb25maWciLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlQnV0dG9uIiwicHJvZmlsZUF2YXRhck1vZGFsIiwicHJvZmlsZUltYWdlIiwicHJvZmlsZUF2YXRhck1vZGFsRm9ybSIsInVzZXJJbmZvIiwicHJvZmlsZU5hbWUiLCJqb2IiLCJfcHJvZmlsZU5hbWUiLCJfam9iIiwiZ2V0VXNlckluZm8iLCJwcm9maWxlSm9iIiwic2V0VXNlckluZm8iLCJhYm91dCIsImNhcmRTZWN0aW9uIiwicmVuZGVyZXIiLCJjb250YWluZXIiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwiYWRkSXRlbSIsInByZXBlbmQiLCJjYXJkRGF0YSIsImltYWdlUG9wdXAiLCJjYXJkRWxlbWVudCIsImNhcmREZWxldGVNb2RhbCIsInNldFN1Ym1pdEFjdGlvbiIsImFwaSIsImRlbGV0ZUNhcmQiLCJsaWtlQ2FyZCIsInRoZW4iLCJyZXMiLCJ1bmxpa2VDYXJkIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiZmV0Y2giLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJjYXRjaCIsImVycm9yIiwiZ2V0VXNlckF2YXRhciIsInNldFVzZXJBdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJhZGRDYXJkIiwiY2FyZElkIiwiYXV0aG9yaXphdGlvbiIsImF2YXRhciIsIl9hbnN3ZXJCdXR0b24iLCJmbiIsImFkZEZvcm1WYWxpZGF0b3IiLCJwcm9maWxlQXZhdGFyRm9ybVZhbGlkYXRvciIsIl9pbWFnZUZ1bGwiLCJfbW9kYWxUaXRsZSIsInNldEF0dHJpYnV0ZSIsImNhcmRQb3B1cCIsInByb2ZpbGVQb3B1cCIsInVybCIsInVzZXJJbmZvUG9wdXAiXSwic291cmNlUm9vdCI6IiJ9